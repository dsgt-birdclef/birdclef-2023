<script>
    import AgreementTable from "./AgreementTable.svelte";
    import AgreementPercentPlot from "./AgreementPercentPlot.svelte";
    import AgreementCountPlot from "./AgreementCountPlot.svelte";
    import AgreementClusterStaticPlot from "./AgreementClusterStaticPlot.svelte";

    export let data;
</script>

# Embedding K-NN Labels

We attempt to improve the performance of the BirdNET classifier by running it through a K-NN classifier.
For each recording in the BirdCLEF 2022 training dataset (last year's dataset), we generate an embedding using non-overlapping 3-second clips.
Then we use the mode of the closest 50 neighbors to assign a label to the clip.

## K-NN Agreement

We first test agreement between the primary label of the clips i.e., which directory the clip was categorized in, and the label assigned by BirdNET.
We refer to this label as the "ego" label, where ego refers to the node at the center of a neighborhood graph.
We refer to the label generated by K-NN classification as the "knn" label.

<AgreementTable data={data.agreement} />

<AgreementCountPlot data={data.agreement} />

What is the relationship between the counts of the ego and knn labels here?
It's hard to tell at first glance whether the slope of the log-log plot is less or greater than 1.

<AgreementPercentPlot data={data.agreement} />

Generally, we're able to see a marked improvement in agreement between the ego and knn labels.
Note that quite a few points lie in the top-left quandrant, which represent cases where K-NN labels are more accurate than the initial BirdNET labels.

## Clustering Labeling Plots
<AgreementClusterStaticPlot data={data.agreement}/>